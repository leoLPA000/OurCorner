<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Libro de eventos especiales para RocÃ­o - OurCorner">
    <meta name="theme-color" content="#764ba2">
    <title>Eventos Especiales ğŸª | OurCorner</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="../assets/css/eventos-libro.css">

    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Great+Vibes&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- BotÃ³n de regreso -->
    <a href="../index.html" class="btn-back">
        <span>â†</span>
        <span>Volver al Inicio</span>
    </a>

    <div class="eventos-container">
        <!-- Header -->
        <header class="eventos-header">
            <h1>ğŸª Nuestros Eventos Especiales ğŸª</h1>
            <p>Momentos mÃ¡gicos guardados en nuestro librito de recuerdos</p>
        </header>

        <!-- Libro de tarjetas -->
        <div class="libro-wrapper">
            <div class="cards-stack" id="cardsStack">
                <!-- Las tarjetas se generarÃ¡n dinÃ¡micamente aquÃ­ -->
            </div>

            <!-- NavegaciÃ³n -->
            <div class="cards-navigation">
                <button class="btn-nav-card" id="btnPrevious" onclick="previousCard()">
                    â† Anterior
                </button>
                <div class="page-indicator" id="pageIndicator">
                    Tarjeta 1 de 1
                </div>
                <button class="btn-nav-card" id="btnNext" onclick="nextCard()">
                    Siguiente â†’
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/js/data/eventosData.js"></script>
    <script>
        // Estado actual
        let currentCardIndex = 0;
        let totalCards = 0;
        let isAnimating = false;

        /**
         * Generar color de pestaÃ±a segÃºn el evento
         */
        function getTabColor(eventId) {
            const colors = {
                'navidad-2024': '#2d5016',
                'anio-nuevo-2025': '#ffd700',
                'san-valentin-2025': '#ff1744',
                'aniversario-2025': '#e91e63',
                'primavera-2025': '#f48fb1',
                'verano-2025': '#ffb300'
            };
            return colors[eventId] || '#ff6b9d';
        }

        /**
         * Crear HTML de una tarjeta de evento
         */
        function createCardHTML(event, index) {
            const tabColor = getTabColor(event.id);
            return `
                <div class="event-card ${index === 0 ? 'active' : 'next'}" data-index="${index}">
                    <div class="card-tab" style="background: ${tabColor};">
                        ${event.icono}
                    </div>
                    <div class="card-content">
                        <div class="event-icon">${event.icono}</div>
                        <h2 class="event-name">${event.nombre}</h2>
                        <p class="event-date">${event.fecha}</p>
                        <p class="event-description">${event.descripcion}</p>
                        <a href="${event.url}" class="btn-access-event">
                            âœ¨ Acceder al Evento
                        </a>
                    </div>
                </div>
            `;
        }

        /**
         * Renderizar todas las tarjetas
         */
        function renderCards() {
            const events = obtenerEventos();
            totalCards = events.length;
            const stack = document.getElementById('cardsStack');

            // Generar HTML de todas las tarjetas
            stack.innerHTML = events.map((event, index) => createCardHTML(event, index)).join('');

            // Actualizar indicador
            updateIndicator();
            updateNavigationButtons();
        }

        /**
         * Ir a la siguiente tarjeta
         */
        function nextCard() {
            if (isAnimating || currentCardIndex >= totalCards - 1) return;

            isAnimating = true;
            const cards = document.querySelectorAll('.event-card');
            const currentCard = cards[currentCardIndex];

            // Animar tarjeta actual hacia la izquierda
            currentCard.classList.add('flipping');
            currentCard.classList.remove('active');

            // Incrementar ANTES de la animaciÃ³n para evitar saltos
            currentCardIndex++;

            // Activar tarjeta siguiente inmediatamente
            cards[currentCardIndex].classList.remove('next');
            cards[currentCardIndex].classList.add('active');

            // Actualizar UI inmediatamente
            updateIndicator();
            updateNavigationButtons();

            // DespuÃ©s de la animaciÃ³n, limpiar clases
            setTimeout(() => {
                currentCard.classList.remove('flipping');
                currentCard.classList.add('previous');
                isAnimating = false;
            }, 600);
        }

        /**
         * Ir a la tarjeta anterior
         */
        function previousCard() {
            if (isAnimating || currentCardIndex <= 0) return;

            isAnimating = true;
            const cards = document.querySelectorAll('.event-card');

            // Desactivar tarjeta actual
            cards[currentCardIndex].classList.remove('active');
            cards[currentCardIndex].classList.add('next');

            // Activar tarjeta anterior
            currentCardIndex--;
            const previousCard = cards[currentCardIndex];
            previousCard.classList.remove('previous');
            previousCard.classList.add('active');

            setTimeout(() => {
                updateIndicator();
                updateNavigationButtons();
                isAnimating = false;
            }, 100);
        }

        /**
         * Actualizar indicador de pÃ¡gina
         */
        function updateIndicator() {
            const indicator = document.getElementById('pageIndicator');
            indicator.textContent = `Tarjeta ${currentCardIndex + 1} de ${totalCards}`;
        }

        /**
         * Actualizar botones de navegaciÃ³n
         */
        function updateNavigationButtons() {
            const btnPrev = document.getElementById('btnPrevious');
            const btnNext = document.getElementById('btnNext');

            btnPrev.disabled = currentCardIndex === 0;
            btnNext.disabled = currentCardIndex === totalCards - 1;
        }

        /**
         * NavegaciÃ³n con teclado
         */
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                previousCard();
            } else if (e.key === 'ArrowRight') {
                nextCard();
            }
        });

        /**
         * Soporte para swipe en mÃ³viles
         */
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swipe left -> siguiente
                    nextCard();
                } else {
                    // Swipe right -> anterior
                    previousCard();
                }
            }
        }

        // Inicializar al cargar
        renderCards();
    </script>
</body>

</html>